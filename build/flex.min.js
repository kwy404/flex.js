/*!
 * flex 1.0.0
 * 
 *
 * Author: kaway
 * Licensed under ISC (https://opensource.org/licenses/ISC)
 *
 * Date: 2023-04-05
 */
const ATTR_EACH="*each";function eachLoop(t,r,n){if(n){var o=t.getAttribute(ATTR_EACH);if(o){const[i,e]=o.split(" in ");o=r[e];if(Array.isArray(o)){t.removeAttribute(ATTR_EACH);var s=t.parentElement;const a=t.cloneNode(!0),c=(t.innerHTML="",document.createElement(s.tagName).cloneNode(!0));o.forEach(t=>{var e=a.cloneNode(!0);e.innerHTML=e.innerHTML.replace(new RegExp(`\\[\\s*${i}\\s*\\]`,"g"),t),c.appendChild(e)});s=parseText().text(c.innerHTML);let e="";s&&s.forEach(t=>{t.key&&(e=c.innerHTML.replaceAll(t.text,r[t.key]))}),n.innerHTML=e,t.innerHTML!==n.innerHTML&&(n.innerHTML=e)}}}}const ATTR_IF="*if";function parseIf(t){return t}function ifCondition(element,state,targetElement){if(targetElement){const ifAttr=element.getAttribute(ATTR_IF);if(ifAttr){const condition=parseIf(ifAttr),shouldShow=eval(condition);shouldShow&&(console.log(shouldShow),element.innerHTML!==targetElement.innerHTML)&&(targetElement.style.display="")}Array.from(element.children).forEach(t=>this.ifCondition(t,state)),JSON.stringify(state)!==JSON.stringify(this.state)&&(this.state=this.createStateProxy(state))}}const FlexInstance=function(){let s;return{create:function(t){{var[{root:e="html",state:r={},methods:n={}}]=[t];class o{constructor(){this.eachLoop=eachLoop,this.ifCondition=ifCondition,this.parseText=parseText(),this.root=e,this.state=this.createStateProxy(r),this.prevState={},this.rootements=Array.from(document.querySelectorAll(this.root+" *")).filter(t=>t.childNodes.length&&""!==t.textContent.trim()),this.cloneNode=parseHTML(this.root),this.startApp(),this.methods=n,this.setupMethods({methods:n})}createStateProxy(t){const n=t=>{if(Array.isArray(t))return new Proxy(t,{set:(t,e,r)=>(t[e]=r,this.updateElements(),!0),defineProperty:(t,e,r)=>{t=Reflect.defineProperty(t,e,r);return"length"===e&&this.updateElements(),t},deleteProperty:(t,e)=>{t=Reflect.deleteProperty(t,e);return this.updateElements(),t}});if("object"!=typeof t||null===t)return t;var e={};for(const r in t)e[r]=n(t[r]);return new Proxy(e,{set:(t,e,r)=>(t[e]=r,this.updateElements(),!0),deleteProperty:(t,e)=>{t=Reflect.deleteProperty(t,e);return this.updateElements(),t}})};return n(t)}startApp(){this.rootements.forEach((e,t)=>{var r;e.nodeType===Node.TEXT_NODE?(r=this.parseText.text(e.textContent))&&r.forEach(t=>{t.key&&(e.textContent=e.textContent.replace(t.text,this.state[t.key]))}):Array.from(e.childNodes).forEach(e=>{var t;e.nodeType===Node.TEXT_NODE&&(t=this.parseText.text(e.textContent))&&t.forEach(t=>{t.key&&(e.textContent=e.textContent.replace(t.text,this.state[t.key]))})})}),this.rootements.forEach((t,e)=>{this.eachLoop(t,this.state,this.rootements[e]),this.ifCondition(t,this.state,this.rootements[e])})}updateElements(){if(this.state!==this.prevState){const e=document.querySelectorAll(this.root+" *");var t=this.cloneNode.cloneNode(!0);Array.from(t.querySelectorAll("*")).forEach((t,r)=>{const o=e[r];if(o&&this.eachLoop(t,this.state,o),t.nodeType===Node.TEXT_NODE){r=this.parseText.text(t.textContent);if(r){let e=t.textContent;r.forEach(t=>{t.key&&(e=e.replace(t.text,this.state[t.key]))}),o.textContent=e}}else Array.from(t.childNodes).forEach((t,r)=>{if(t.nodeType===Node.TEXT_NODE){var n=this.parseText.text(t.textContent);if(n){let e=t.textContent;n.forEach(t=>{t.key&&(e=e.replace(t.text,this.state[t.key]))}),o.childNodes[r].textContent=e}}})})}}setupMethods({methods:a={}}){var t=this.cloneNode.cloneNode(!0);const c=document.querySelectorAll(this.root+" *"),l=this;Array.from(t.querySelectorAll(this.root+" *")).forEach((e,r)=>{var n=e.attributes;for(let t=0;t<n.length;t++){var o=n[t].name,s=o.replace("@","");if(o&&"@"===o[0]){const i=e.getAttribute(o);c[r].addEventListener(s,function(){"function"==typeof a[i]&&a[i].call(l)}),e.removeAttribute(o),e.cloneNode(!0)}}})}}return{getInstance:function(){return s||(flex.console.warn("InstÃ¢ncia do Flex foi criada com sucesso.",{debug:!1}),s=new o),s}}}}}}();let flex={};function parseText(){const o=/\{(.+?)\}/;return{text:function(t){if(!o.test(t))return null;for(var e,r,n=[];e=t.match(o);)0<(r=e.index)&&n.push(t.slice(0,r)),n.push({text:e[0],key:e[1].trim()}),t=t.slice(r+e[0].length);return t.length&&n.push(t),n}}}function parseHTML(t){return document.querySelector(t).cloneNode(!0)}flex.console={warn(t,{silent:e=!1,debug:r=!1}){e&&!r||(console.warn("[Flex warn]: "+t),r&&console.warn(new Error("Warning Stack Trace").stack))}};